// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Participant {
  participantId String   @id @default(uuid())
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  info          String? // TODO: Use Json here once Prisma supports it
  runs          Run[]

  @@map("wwl_participant")
}

model Study {
  studyId   String   @id
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  info      String? // TODO: Use Json here once Prisma supports it
  runs      Run[]

  @@map("wwl_study")
}

model Run {
  runId         String      @id @default(uuid())
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  info          String? // TODO: Use Json here once Prisma supports it
  finished      Boolean     @default(false)
  participant   Participant @relation(fields: [participantId], references: [participantId])
  study         Study       @relation(fields: [studyId], references: [studyId])
  responses     Response[]
  participantId String
  studyId       String

  @@map("wwl_run")
}

model Response {
  responseId String   @id @default(uuid())
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  name       String?
  payload    String? // TODO: Use Json here once Prisma supports it
  run        Run      @relation(fields: [runId], references: [runId])
  runId      String

  @@map("wwl_response")
}
